<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Random Program Interpreter</title>
    <style>
        .cats { color: red; }
    </style>
    <script type="module">
        const code = document.getElementById("code");

        function recolor() {

            code.childNodes.forEach(
                function(node) {
                    if (node.classList.contains("cats") && node.innerText != "cats") {
                        node.replaceWith(node.innerText);
                    }
                }
            );
            
            // https://developer.mozilla.org/en-US/docs/Web/API/Selection
            // https://developer.mozilla.org/en-US/docs/Web/API/Range
            // const start = 10;//window.getSelection().rangeCount == 0 ? -1 : window.getSelection().getRangeAt(0).startOffset;
            
            // code.innerHTML = code.innerText.replaceAll("\n", "<br>").replaceAll("cats", "<span class='cats'>cats</span>");

            // if (start != -1) {
                
            //     const range = document.createRange();
            //     range.setStart(code, start);
            //     range.setEnd(code, start);
                
            //     const selection = window.getSelection();
            //     selection.removeAllRanges();
            //     selection.addRange(range);
            // }
        }

        recolor();
        code.addEventListener("input", recolor);
    </script>
</head>
<body>
    <div id="code" style="tab-size: 4; padding: 1em; border: 1px solid grey; height: 30em;" spellcheck="false" autocorrect="off" autocapitalize="none" translate="no" contenteditable="true" role="textbox" aria-multiline="true">
        I really like cats! If you don't like cats, don't buy cats!
    </div>
</body>
</html>
